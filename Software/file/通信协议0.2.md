---
title: 通讯协议
---
该版本参考匿名的通信协议，主要是可以先用他们的上位机来进行测试，提高开发速度

# 飞机对地面站
## 飞机姿态信息

| 帧头 | 功能字 | 长度   | 数据  | 校验    |
| ---- | ------ | ------ | ----- | --- |
| AAAA | 0X01     | 0XOC  | 12byte | 1byte    |

| 数据  | 格式 |
| --------- | ----- |
| ROLL * 100  | int16 |
| PITCH * 100 | int16 |
| YAW * 100   | int16 |
| HIGHT     | int32 |
| FLY_MODEL | uint8 |
| ARMED     |   uint8   |



## 飞机传感器数据
| 帧头 | 功能字 | 长度   | 数据  | 校验    |
| ---- | ------ | ------ | ----- | --- |
| AAAA | 0X02     | 0X12  | 18byte | 1byte    |

| 数据 | 格式 |
| ----- | ----- |
| ACC_X | int16 |
| ACC_Y | int16 |
| ACC_Z | int16 |
| GYR_X | int16 |
| GYR_Y | int16 |
| GYR_Z | int16 |
| MAG_X | int16 |
| MAG_Y | int16 |
| MAG_Z |  int16     |

## 接收到的控制信息

| 帧头 | 功能字 | 长度   | 数据  | 校验    |
| ---- | ------ | ------ | ----- | --- |
| AAAA | 0X03     | 0X14  | 20byte | 1byte    |

| 数据 | 格式  |
| ---- | ----- |
| THR  | int16 |
| YAW  | int16 |
| ROL  | int16 |
| PIT  | int16 |
| AUX1 | int16 |
| AUX2 | int16 |
| AUX3 | int16 |
| AUX4 | int16 |
| AUX5 | int16 |
| AUX6 | int16  |

## PID数据
| 帧头 | 功能字 | 长度   | 数据  | 校验    |
| ---- | ------ | ------ | ----- | --- |
| AAAA | 0X10     | 0X12  | 18byte | 1byte    |

| 数据   | 格式  |
| ------ | ----- |
| PID1_P | int16 |
| PID1_I | int16 |
| PID1_D | int16 |
| PID2_P | int16 |
| PID2_I | int16 |
| PID2_D | int16 |
| PID3_P | int16 |
| PID3_I | int16 |
| PID3_D | int16 |

## 接收应答
| 帧头 | 功能字 | 长度   | 接收的功能字  |接收的和校验 |校验    |
| ---- | ------ | ------ | ----- | --- | --- |
| AAAA | 0XEF   | 0X02  | uint8 | uint8| 1byte    |

*比如要返回PID1数据帧，接收功能字=0x10，接收的校验和就是PID数据帧计算出的校验和*


# 地面站对飞机
## 命令类1
| 帧头 | 功能字 | 长度 | 命令  | 校验  |
| ---- | ------ | ---- | ----- | ----- |
| AAAF | 0X01   | 1    | uint8 | 1byte |

| 命令字 | 说明     |
| ------ | -------- |
| 0x01   | ACC校准  |
| 0x02   | GYRO校准 |
| 0x04   | MAG校准  |
| 0xA0   | 飞机锁定 |
| 0XA1   |  飞机解锁    |
## 命令类2
| 帧头 | 功能字 | 长度 | 命令  | 校验  |
| ---- | ------ | ---- | ----- | ----- |
| AAAF | 0X02   | 1    | uint8 | 1byte |

| 命令字 | 说明     |
| ------ | -------- |
| 0x01   | 读取PID  |

## 控制数据
| 帧头 | 功能字 | 长度 | 数据  | 校验  |
| ---- | ------ | ---- | ----- | ----- |
| AAAF | 0X03   | 0x14    | 20byte | 1byte |

| 数据 | 格式  |
| ---- | ----- |
| THR  | int16 |
| YAW  | int16 |
| ROL  | int16 |
| PIT  | int16 |
| AUX1 | int16 |
| AUX2 | int16 |
| AUX3 | int16 |
| AUX4 | int16 |
| AUX5 | int16 |
| AUX6 | int16  |


## 更新PID

| 帧头 | 功能字 | 长度 | 数据  | 校验  |
| ---- | ------ | ---- | ----- | ----- |
| AAAF | 0X10   | 0x12    | 18byte | 1byte |

| 数据   | 格式  |
| ------ | ----- |
| PID1_P | int16 |
| PID1_I | int16 |
| PID1_D | int16 |
| PID2_P | int16 |
| PID2_I | int16 |
| PID2_D | int16 |
| PID3_P | int16 |
| PID3_I | int16 |
| PID3_D | int16 |
